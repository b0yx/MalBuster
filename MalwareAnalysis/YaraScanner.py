import os
from colorama import Fore, Style, init

# Initialize colorama for Windows compatibility
init(autoreset=True)

def clear_screen():
    """Clears the terminal screen for better readability."""
    os.system('cls' if os.name == 'nt' else 'clear')

def display_banner():
    """Displays a stylized banner."""
    banner = """
==============================
       YARA SCANNER
==============================
    """
    print(Fore.CYAN + banner)

def display_menu():
    """Displays the main menu with colors."""
    clear_screen()
    display_banner()

    print(Fore.YELLOW + f"""
    {Fore.BLUE}[1] {Fore.CYAN}Scan a File with YARA Rules
    {Fore.BLUE}[2] {Fore.CYAN}Load Custom YARA Rules
    {Fore.BLUE}[3] {Fore.CYAN}List Loaded YARA Rules
    {Fore.RED}[0] Exit
    """)

    choice = input(Fore.YELLOW + "Enter Your Choice: " + Style.RESET_ALL)
    handle_choice(choice)

def handle_choice(choice):
    """Handles menu selection."""
    if choice == "1":
        print(Fore.GREEN + "Scanning a file with YARA rules...")
        # Add functionality for scanning a file here
    elif choice == "2":
        print(Fore.GREEN + "Loading custom YARA rules...")
        # Add functionality for loading custom YARA rules here
    elif choice == "3":
        print(Fore.GREEN + "Listing loaded YARA rules...")
        # Add functionality for listing loaded YARA rules here
    elif choice == "0":
        print(Fore.RED + "Exiting. Goodbye!")
        exit(0)
    else:
        print(Fore.RED + "Invalid Choice. Please Try Again.")
    
    input(Fore.YELLOW + "Press Enter to continue...")
    display_menu()

# Start the program if executed directly
if __name__ == "__main__":
    display_menu()