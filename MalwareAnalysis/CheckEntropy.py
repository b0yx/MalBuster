import sys
import os
import pyfiglet
import shutil
from colorama import Fore, Style, init

# Initialize colorama for Windows compatibility
init(autoreset=True)

# Global variable for entropy threshold
ENTROPY_THRESHOLD = 7.0  # Default entropy threshold

def clear_screen():
    """Clears the terminal screen for better readability."""
    os.system('cls' if os.name == 'nt' else 'clear')

def display_banner():
    """Displays a stylized banner using pyfiglet."""
    try:
        terminal_width = shutil.get_terminal_size().columns
    except:
        terminal_width = 80  # Fallback width if terminal size cannot be determined

    banner = pyfiglet.figlet_format("ENTROPY ANALYZER", font="slant")
    banner_lines = banner.split("\n")
    centered_banner = "\n".join(line.center(terminal_width) for line in banner_lines)

    print(Fore.CYAN + "=" * terminal_width)
    print(Fore.GREEN + centered_banner)
    print(Fore.CYAN + "=" * terminal_width + Style.RESET_ALL)

def display_menu():
    """Displays the main menu with colors."""
    clear_screen()
    display_banner()

    print(Fore.YELLOW + f"""
    {Fore.BLUE}[1] {Fore.CYAN}Check File Entropy
    {Fore.BLUE}[2] {Fore.CYAN}Set Entropy Threshold {Fore.MAGENTA}(Current: {ENTROPY_THRESHOLD})
    {Fore.BLUE}[3] {Fore.CYAN}Save Entropy Results
    {Fore.RED}[0] Exit
    """)

    choice = input(Fore.YELLOW + "Enter Your Choice: " + Style.RESET_ALL)
    handle_choice(choice)

def handle_choice(choice):
    """Handles menu selection."""
    global ENTROPY_THRESHOLD

    if choice == "1":
        print(Fore.GREEN + "Checking file entropy...")
        # Add functionality for checking file entropy here
    elif choice == "2":
        print(Fore.GREEN + "Setting entropy threshold...")
        # Add functionality for setting entropy threshold here
    elif choice == "3":
        print(Fore.GREEN + "Saving entropy results...")
        # Add functionality for saving entropy results here
    elif choice == "0":
        print(Fore.RED + "Exiting. Goodbye!")
        exit(0)
    else:
        print(Fore.RED + "Invalid Choice. Please Try Again.")
    
    input(Fore.YELLOW + "Press Enter to continue...")
    display_menu()

# Start the program if executed directly
if __name__ == "__main__":
    display_menu()